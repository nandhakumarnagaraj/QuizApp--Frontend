<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-4 text-white">
    <h2>Edit Quiz</h2>
    <a [routerLink]="['/quiz', quiz.quizId]" class="btn btn-outline-light">Cancel</a>
  </div>

  <div *ngIf="loading" class="text-center text-white">
    <div class="spinner-border" role="status"></div>
  </div>

  <form *ngIf="!loading" (ngSubmit)="onSubmit()">
    <div class="card mb-4 p-4">
      <label class="form-label fw-bold">Quiz Title</label>
      <input type="text" [(ngModel)]="quiz.quizText" name="quizText" class="form-control" required />
    </div>

    <div *ngFor="let question of quiz.questions; let qi = index" class="card mb-3 p-4">
      <div class="d-flex justify-content-between mb-3">
        <h5 class="text-primary">Question {{ qi + 1 }}</h5>
        <button type="button" (click)="removeQuestion(qi)" class="btn btn-sm btn-danger" *ngIf="quiz.questions.length > 1">Remove</button>
      </div>
      
      <input type="text" [(ngModel)]="question.questionText" [name]="'q' + qi" class="form-control mb-3" placeholder="Question text" required />

      <div class="row g-2">
        <div class="col-md-6" *ngFor="let option of question.options; let oi = index">
          <div class="input-group">
            <div class="input-group-text">
              <input class="form-check-input mt-0" type="radio" [name]="'correct' + qi" [checked]="option.correct" (change)="setCorrectOption(qi, oi)">
            </div>
            <input type="text" [(ngModel)]="option.optionText" [name]="'opt' + qi + '_' + oi" class="form-control" required />
          </div>
        </div>
      </div>
    </div>

    <div class="d-flex gap-2 mt-4">
      <button type="button" (click)="addQuestion()" class="btn btn-success">+ Add Question</button>
      <button type="submit" [disabled]="saving" class="btn btn-primary flex-grow-1">
        {{ saving ? 'Saving...' : 'Update Quiz' }}
      </button>
    </div>
  </form>
</div>